import numpy as np
import pandas as pd
import datetime as dt
import xarray as xr

def nino():
    #https://psl.noaa.gov/gcos_wgsp/Timeseries/Data/nino34.long.anom.data
    # 1978-10 onwards (1979-01 onwards for post-5month rolling mean)
    nino = np.array([ -0.15,0.07, 
                        0.05,0.09,0.13,0.17,-0.09,0.04,-0.2,0.21,0.48,0.32,0.35,0.69,
                        0.55,0.33,0.09,0.2,0.13,0.37,0.02,-0.23,-0.12,-0.11,0.1,0.36,
                        -0.45,-0.45,-0.02,-0.17,-0.11,-0.15,-0.43,-0.18,-0.07,-0.03,-0.27,0.07,
                        -0.04,-0.13,-0.02,0.24,0.65,0.92,0.64,0.93,1.39,2,2.07,2.33,
                        2.43,2.22,1.69,1.12,1.12,0.62,-0.11,-0.13,-0.5,-1.03,-1.13,-0.95,
                        -0.8,-0.53,-0.48,-0.6,-0.64,-0.9,-0.4,-0.4,-0.35,-0.83,-1.18,-1.53,
                        -0.89,-0.91,-0.96,-0.98,-0.9,-0.76,-0.61,-0.49,-0.57,-0.64,-0.43,-0.4,
                        -0.79,-0.64,-0.51,-0.41,-0.47,-0.08,0.16,0.24,0.59,0.9,1.04,0.98,
                        1.19,1.17,1.24,0.89,0.91,1.24,1.34,1.48,1.53,1.36,1.29,1.05,
                        0.69,0.35,0.29,-0.49,-1.05,-1.46,-1.54,-1.44,-1.33,-2.09,-2.18,-1.98,
                        -1.95,-1.37,-1.33,-1.11,-0.8,-0.64,-0.47,-0.58,-0.38,-0.4,-0.3,-0.13,
                        0.02,0.36,0.2,0.26,0.32,0,0.15,0.17,0.12,0.13,0.08,0.32,
                        0.51,0.32,0.1,0.21,0.44,0.65,0.62,0.43,0.22,0.91,1.14,1.62,
                        1.61,1.62,1.5,1.41,1.27,0.53,0.27,-0.15,-0.14,-0.35,-0.14,0.04,
                        0.28,0.42,0.47,0.92,0.93,0.64,0.33,0.16,0.26,0.36,0.28,0.19,
                        0.03,-0.16,-0.06,0.03,0.14,0.27,0.16,0.52,0.4,0.9,1.14,1.21,
                        1.1,0.87,0.49,0.27,0.03,0.08,0.03,-0.38,-0.57,-0.72,-0.78,-0.72,
                        -0.65,-0.66,-0.48,-0.34,-0.4,-0.12,-0.14,-0.3,-0.34,-0.28,-0.3,-0.43,
                        -0.43,-0.24,-0.06,0.34,0.87,1.15,1.6,1.94,2.1,2.29,2.42,2.3,
                        2.42,2.08,1.49,0.9,0.68,-0.39,-0.73,-0.83,-0.82,-1.19,-1.23,-1.51,
                        -1.53,-1.41,-0.92,-0.81,-0.87,-0.95,-0.84,-0.98,-0.84,-1.03,-1.41,-1.54,
                        -1.79,-1.53,-1.26,-0.8,-0.8,-0.75,-0.57,-0.36,-0.39,-0.55,-0.75,-0.92,
                        -0.88,-0.63,-0.48,-0.3,-0.3,-0.11,0.01,-0.07,-0.28,-0.26,-0.28,-0.46,
                        -0.14,0,0.11,0.14,0.21,0.68,0.57,0.7,0.82,1.16,1.41,1.41,
                        0.98,0.64,0.48,-0.03,-0.52,-0.19,0.14,0.05,0.15,0.46,0.39,0.32,
                        0.26,0.17,-0.1,0.06,0.1,0.14,0.41,0.66,0.67,0.73,0.62,0.71,
                        0.56,0.26,0.28,0.28,0.3,0.22,-0.01,-0.04,-0.08,-0.15,-0.44,-0.75,
                        -0.98,-0.71,-0.73,-0.3,-0.11,0.09,0.03,0.37,0.63,0.76,0.98,1.1,
                        0.59,0.12,-0.15,-0.16,-0.39,-0.16,-0.37,-0.57,-1.04,-1.4,-1.58,-1.61,
                        -1.79,-1.7,-1.17,-0.89,-0.64,-0.44,-0.04,-0.04,-0.28,-0.3,-0.37,-0.9,
                        -1,-0.71,-0.72,-0.25,0.17,0.49,0.69,0.62,0.68,0.96,1.49,1.81,
                        1.43,1.18,1.07,0.56,-0.15,-0.62,-0.89,-1.33,-1.56,-1.65,-1.57,-1.63,
                        -1.7,-1.26,-0.98,-0.74,-0.53,-0.25,-0.23,-0.66,-0.76,-0.93,-1.09,-1.05,
                        -0.93,-0.61,-0.48,-0.29,-0.18,0.14,0.44,0.66,0.44,0.23,0.33,-0.13,
                        -0.42,-0.4,-0.14,-0.08,-0.28,-0.33,-0.28,-0.29,-0.09,-0.24,-0.02,-0.09,
                        -0.42,-0.45,-0.07,0.28,0.45,0.48,0.13,0.14,0.37,0.48,0.89,0.77,
                        0.59,0.57,0.48,0.9,1.04,1.28,1.56,1.87,2.01,2.21,2.57,2.56,
                        2.56,2.11,1.6,1.05,0.45,0.06,-0.25,-0.48,-0.46,-0.75,-0.63,-0.51,
                        -0.34,-0.01,-0.09,0.22,0.3,0.22,0.22,-0.18,-0.56,-0.52,-0.84,-0.85,
                        -0.86,-0.73,-0.73,-0.36,-0.12,0.12,0.27,0.05,0.3,0.84,1,0.97,
                        0.51,0.62,0.81,0.67,0.61,0.66,0.41,0.19,0.11,0.55,0.74,0.51,
                        0.64,0.48,0.36,0.49,-0.12,-0.21,-0.04,-0.42,-0.66,-1.19,-1.01,-0.98])
    nino = np.convolve(nino,np.ones(5)/5,mode='valid')
    time = [dt.datetime(1979+i//12,i%12+1,1) for i in range(len(nino))]
    nino = pd.Series(nino,index=time)
    return nino


def dmi():
    dmi=xr.open_dataset("/g/data/tp28/dev/eh6215/datasets/dmi.nc")
    dmi = pd.Series(dmi.DMI.values,index=dmi.WEDCEN2.values)
    dmi=dmi.resample('M').mean()
    return dmi


def sam():
    #http://www.nerc-bas.ac.uk/public/icd/gjma/newsam.1957.2007.txt
    sam = [-0.87,-2.27,0.07,-1.97,-2.5,-0.87,1,-1.73,0.72,-3.12,-5.42,-2.63,
    0.04,-2.84,-2.52,-0.3,-2.72,-0.97,-1.65,0.97,1.9,-0.16,0.3,0.82,
    1.59,-0.19,-0.54,-1.25,-0.32,-1.12,0.18,-1.64,2.46,-0.46,3.28,-0.38,
    0.9,0.85,3.4,-0.35,-0.6,-0.17,0.31,0.43,1.41,-1.17,1.18,1.36,
    0.91,-4,-0.4,-0.14,1.12,-0.4,0.98,1.1,-1.21,1.64,1.52,2.32,
    2.34,-0.5,-0.66,1.65,-0.66,-3.41,0.33,-0.2,-0.15,-0.36,-2.25,1.35,
    3.26,1.41,2.03,1.41,-1.09,1.82,0.41,-5.03,-1.59,2.05,1.02,-0.04,
    -3.29,-1,-1.52,0.63,2.38,-4.14,-6.15,-2.26,1.61,0.34,-3.34,-1.49,
    -0.46,-7.65,-1.58,-0.49,-2.08,1.89,0.08,0.08,0.22,1.91,1.71,-1.48,
    0.59,-2.94,-2.81,-0.49,-1.66,0.53,-1.65,3.66,0.43,1.3,-1.81,-0.67,
    -3.42,-4.22,1.09,-0.11,-0.39,2.62,1.22,1.01,1.21,0.64,-2.17,-0.48,
    -0.07,-1.82,-0.9,-2.72,-2.23,-0.13,1.6,0.25,-0.36,-3.15,-3.36,-0.51,
    -4.13,-3.14,-0.96,-2.36,1.39,-0.88,1.81,2.1,0.58,-0.35,1.52,-0.41,
    0.76,1.27,-2.26,-1.57,0.24,0.72,-1.22,1.63,-2.02,-2.19,0.45,-0.72,
    -0.36,0.16,2.02,-1.24,-2.48,1.31,0.68,-0.78,-1.83,-2.23,-0.5,-1.57,
    -1.44,-0.36,-2.05,-2.94,-0.09,0.42,-1.24,-1.89,-0.91,-1.48,1.39,-1.38,
    -0.94,1.39,2.16,0.36,-1.94,-0.12,2.57,1.98,-1.15,-1.28,-0.54,2.17,
    1.18,1.82,2.81,0.05,0.42,0.08,-1.22,-4.02,1.84,-1.33,-2.24,-2.37,
    -1.68,-1.22,-1.23,0.56,-3.33,-0.35,-2.42,-0.16,1.23,0.59,0.11,0.35,
    -1.17,1.02,-0.1,1.56,1.75,-0.01,0.6,0.3,1.67,1.19,-2.88,-5.07,
    -3.22,0.04,-1.17,-1.36,-0.77,-2.09,-1.82,-0.41,2.69,0.21,-0.2,-0.95,
    1.5,-0.24,-0.99,0.64,-0.91,0.83,-2.13,2.94,1.19,0.68,-0.96,-0.01,
    0.74,-0.9,1.51,-0.49,1.54,2.52,3.14,1.39,-0.02,0.54,-1.26,-1.88,
    0.01,-1.75,-2.58,-1.77,-0.51,3.19,-1.68,-1.68,-2.56,0.45,-2.09,-0.1,
    0.84,1.76,-2.47,-3.52,0.88,0.38,-1.43,-1.99,-1.49,-0.39,2.34,2.21,
    -0.77,0.7,4.28,2.89,-0.7,2.4,0.01,1,1.56,-2.14,-2.32,-2.21,
    -2.44,0.89,-0.71,-0.6,-0.68,0.38,1.63,0.09,-0.72,2.05,3.79,1.52,
    -1.96,-1.74,-0.38,-0.23,-0.33,1.08,-0.21,-2.33,-0.16,1.06,0.34,-3.22,
    -2.38,-0.02,-0.08,0.95,0.38,-2.49,2.64,1.26,1.07,0.57,2.28,1.9,
    0.37,-4.89,-1.26,-0.57,-2.19,-0.95,-0.02,1.68,2.72,-0.38,0.5,1.31,
    -2.51,-2.49,-1.11,-0.17,-0.34,0.18,-0.26,1.79,-0.72,0.78,1.77,0.3,
    0.13,0.12,-2.01,2.11,-2.03,-3.06,0.64,-2,-2.7,-6.03,1.77,1.88,
    -0.02,1.14,0.2,0,3.73,2.91,0.88,-1.21,-0.23,-0.16,0.69,-0.05,
    -0.23,1.95,0.8,-3.34,-3.35,-0.28,-1.82,0.12,2.08,-0.06,0.29,-0.2,
    1.5,-1.69,1.07,-1.36,1.02,1.04,-1.56,-0.57,-2.52,1.3,-0.84,-1.23,
    0.17,-1.89,-1.1,0.53,-2.19,-3.13,-0.8,-0.4,1.06,0.7,1.49,0.58,
    -2.17,0.77,-0.1,1.8,2.1,0.4,2.82,2.69,1.14,1.21,1.48,1.38,
    0.53,2.72,1.59,-0.75,-1.5,-2.33,-0.15,1.53,-1.22,-0.47,-2.43,1.91,
    2.89,0.31,-1.12,0.74,2.64,-0.79,-4.26,-0.51,3.09,-0.69,0.17,1.93,
    0.55,-1.74,1.31,-0.28,1.9,-1.4,0.22,-2.46,-3.5,2.79,-2.36,0.03,
    2.37,0.68,1.43,0.15,1.43,0.69,1.82,0.76,0.69,-1.78,-3.17,-0.89,
    2.65,0.57,-0.05,2.89,1.11,1.31,2.13,2.66,0.74,-0.26,2.84,2.59,
    2.26,0.56,-1.39,2.44,2.51,-1.81,0.72,1.44,0.16,3.35,1.83,3.12,
    3.59,2.32,0.74,0.97,1.9,-0.31,0.52,-1.22,-3.2,1.21,-1.32,-2.05,
    1.43,-2.7,-0.57,3.49,-1.75,-0.02,0.2,-0.15,1.46,1.36,2.54,1.16,
    2.22,2.8,-4.42,1.6,-1.69,-0.43,-0.67,1.14,-2.18,-5.77,0.03,1.29,
    -0.52,-0.98,-0.07,2.21,1.04,-2.52,1.2,2.33,-0.99,0.12,-0.15,-0.69,
    2.56,-3.33,0.74,1.2,-0.15,1.69,2.52,0,1.77,-0.59,-1.18,-1.02,
    1.07,1.59,-0.12,3.46,-0.45,-0.41,-0.5,0.5,0.39,-0.11,0.66,-2.76,
    0.56,-1.85,1.66,-0.69,2.28,2.05,1.61,-2.64,-0.26,1.79,0.14,1.34,
    0.03,2.36,-0.77,-0.33,-1.02,-0.65,-2.67,-0.28,-1.88,-0.86,0.03,2.8,
    2.56,1.09,0.63,-0.81,-0.66,3,0.23,0.6,0.46,2.21,1.03,1.01,
    2.02,0.94,0.5,-0.43,-0.14,0.54,-0.13,-2.44,-0.78,1.47,-1.2,1.09,
    -0.4,-2.12,0.04,0.08,1.51,3.14,3.37,1.24,-0.33,3.19,3.88,0.25,
    0.48,0.87,-0.79,1.62,1.37,0.72,-1.52,-0.73,-1.79,0.59,-1.41,3.43,
    3.08,-1.53,0.48,2.18,0.47,1.46,3.18,1.34,0.09,0.83,-0.84,-0.9,
    0.71,2.84,2.31,-0.07,0.88,0.23,1.17,-3.25,-2.72,-1.39,1.07,0.77,
    -0.13,0.36,1.34,1.18,-1.62,-0.21,0.68,1.97,-1.62,1.32,0.35,2.45,
    1.35,4.92,0.88,2.03,0.41,2.41,2,1.86,1.91,-0.66,1.46,0.72,
    3.13,1.35,4.36,1.06,-0.92,3.66,0.81,-1.28,2.46,-0.89,-3.12,-1.52,
    -1.12,-1.09,-1.56,1.65,1.82,1.98,0.16,0.31,0.42,-0.64,3.18,1.44,
    2.72,1.02,-0.03,-1.66,0.01,-1.57,0.55,-0.78,1.83,2.76,2.84,1.44,
    2.79,-1.87,1.47,0.86,-0.11,2.21,-2.2,-2.04,0.81,-1.97,-4.42,-1.78,
    0.57,-0.36,2.05,-1.72,1.03,1.18,-0.97,-2.2,-0.25,1.79,1.14,2.28,
    1.95,2.19,-0.95,0.87,0.75,1.88,-1.06,0.73,1.68,0.8,2.69,2.74,
    2.19,1.92,1.28,2.49,0.25,-2.34,1.24]
    time = [dt.datetime(1957+i//12,i%12+1,1) for i in range(len(sam))]
    sam = pd.Series(sam,index=time)
    return sam